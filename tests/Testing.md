# 测试指南 (Testing Guide)

这个文档将指导你如何运行和理解本项目的测试。即使你从未写过代码测试，也不用担心，这就像给应用做一次全身体检。

## 1. 快速开始 (Quick Start)

在终端中运行以下命令：

### 运行所有测试 (无界面)
```bash
npm test
```
*   **用途**: 快速检查所有功能是否正常。通常在提交代码前运行。
*   **结果**: 你会看到一系列绿色的 `PASS` (通过) 或红色的 `FAIL` (失败)。

### 运行可视化测试 (推荐 ⭐)
```bash
npm run test:ui
```
*   **用途**: 启动一个网页界面，你可以直观地看到每个测试文件，甚至可以查看组件在测试时的样子。
*   **操作**: 浏览器会自动打开。点击左侧的文件名即可运行对应的测试。

---

## 2. 测试文件在哪里？

所有的测试文件都放在 `tests/` 文件夹中：

```text
tests/
├── App.test.tsx                  # 【集成测试】模拟用户玩游戏的完整流程
├── components/
│   └── PuzzlePiece.test.tsx      # 【组件测试】测试单个拼图块的点击和样式
├── services/
│   └── supabase.test.ts          # 【数据测试】测试数据转换逻辑是否正确
├── utils/
│   └── index.test.ts             # 【工具测试】测试洗牌算法等纯函数
└── setup.ts                      # 全局配置（模拟浏览器环境）
```

## 3. 我们测试了什么？

我们采用了“金字塔”策略：

1.  **单元测试 (Unit Tests)**: 
    *   *例子*: `utils/index.test.ts`
    *   *目的*: 测试最小的零件。比如，“洗牌函数”真的把数组打乱了吗？“文字测量”函数是否返回了数字？

2.  **组件测试 (Component Tests)**:
    *   *例子*: `components/PuzzlePiece.test.tsx`
    *   *目的*: 测试界面元素。比如，拼图块被点击时，是否触发了点击事件？选中时是否变蓝了？

3.  **集成测试 (Integration Tests)**:
    *   *例子*: `App.test.tsx`
    *   *目的*: 测试完整流程。我们模拟了一个机器人用户：
        *   等待游戏加载。
        *   看到题目（比如 "Je parle"）。
        *   点击 "parl" 和 "e"。
        *   点击 "Check"。
        *   验证屏幕上是否出现了 "Correct!"。

## 4. 如果测试失败了怎么办？

如果终端出现红色的 `FAIL`：

1.  **读报错信息**: 它通常会告诉你 *Expected* (期望看到什么) 和 *Received* (实际看到了什么)。
    *   例如：`Expected: "Correct!", Received: "Try again"`。
2.  **检查代码变更**: 你最近是否修改了逻辑？
3.  **更新测试**: 如果你故意修改了功能（比如把按钮文字从 "Check" 改成了 "Valider"），你需要去对应的测试文件中更新文字，让测试通过。

## 5. 常用术语

*   **describe**: 描述一组测试（例如 "App 组"）。
*   **it / test**: 描述单个测试用例（例如 "它应该在加载时显示 Loading"）。
*   **expect**: 断言。我期望结果是...（例如 `expect(1+1).toBe(2)`）。
*   **vi.mock**: 模拟。比如我们不想真的连接数据库，就用 `mock` 模拟一个假数据库返回数据。
